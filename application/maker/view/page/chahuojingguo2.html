{extend name="maker@common/base" /}
{block name="printmode"}
<br><br><br>
<div class="layui-main site-inline site-fix">
    {include file="maker@common/sidebar"}
    <div class="site-content">

            <div class="row">
                <div class="col-centered">
                    <textarea id='editor-div'></textarea>
                </div>
            </div>

    </div>

    <script type="text/javascript">
    	
    	var editor, temp;
var mydata = {};
$(document).ready(function() {
    editor = new SquireUI({ replace: 'textarea#editor-div', height: '900' });

    temp = $("#frame1", document.body)[0];

    setTimeout(function(){
        $.ajax({
        type: "GET",
        url: "/documentmaker/public/index.php/maker/api/editorHTML",
        data: '',
        dataType: "json",
        success: function(respMsg) {

            if (respMsg) {
            temp.contentWindow.editor.setHTML(respMsg.templet_content);

        }

        },
        error: function() {
            layer.msg("初始化编辑器失败");
        }
    });  



$('#go_list').click(function() {
    window.location.href = "/documentmaker/public/index.php/maker/templet/index";
});

$('#save').click(function() {
    var myeditor = temp.contentWindow.editor;
    var templet_content = myeditor.getHTML();
    var templet_catalog = $(":input[name='templet_catalog']").val();
    var templet_name = $(":input[name='templet_name']").val();
    mydata.templet_content = templet_content;
    mydata.templet_catalog = templet_catalog;
    mydata.templet_name = templet_name;

    $.ajax({
        type: "POST",
        url: "/documentmaker/public/index.php/maker/api/refreshTemplet",
        data: mydata,
        dataType: "json",
        success: function(respMsg) {
            alert("保存成功！");
        },
        error: function() {
            alert("保存失败，网络故障，稍后再试！");

        }
    });
});

$("#print").click(function(){
	 $("#frame1", document.body)[0].contentWindow.print();
});


},100);

});
    </script>
    {/block}